{% extends 'layout.html' %}

{% block content %}
	<div id="host">
		<h1>Fuck you {{ user.username }}.</h1>
		<a href="http://localhost:6969/join/{{ip}}" target="_blank">http://localhost:6969/join/{{ip}}</a>
                <div class="playlist"></div>
		<div class="searchbox">
			<input type="text" ng-model="query" ng-change="loadsearch()" ng-keyup="loadsearch()" placeholder="Search..." />
		</div>
		<iframe id='player' src="https://embed.spotify.com/?uri=spotify:track:32lm3769IRfcnrQV11LO4E&theme=white&view=coverart" width="300" height="380" frameborder="0" allowtransparency="true" autoplay></iframe>
	</div>
	<script>
		var socket = io.connect('http://{{ip}}:8080');
                var queue_top = 0;
                var queue_bottom = 0;
    socket.on('newTrack', function(data) {
      var trackID = data.uri;
      $('#player').attr("src", "https://embed.spotify.com/?uri=" + trackID + "&theme=white&view=coverart");
      $(".playlist").append("<p id=\"" + queue_top + "\">" + data.name + "</p>");
                $("#"+queue_top).hide().slideDown("slow");
                queue_top++; 
    });

	</script>
{% endblock %}
